{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";async function postData(json,api){const res=await fetch(api,{method:\"POST\",headers:{'content-type':'application/json'},body:JSON.stringify(json)});return res;}const App=_ref=>{let{user_id,program_no,host}=_ref;function sendAPI(){var FileName;postData({Id:user_id},\"\".concat(host,\"/api/pub/acad\")).then(function(response){return response.json();}).then(function(data){postData({Acadno:data.id},\"\".concat(host,\"/api/pub/date\")).then(function(response){if(response.status===204)throw\"不在時限內\";return response.json();}).then(function(data){var json={};json.syearEnd=data.syearEnd;json.semEnd=data.semEnd;json.StudentId=user_id;postData(json,\"\".concat(host,\"/api/Calculate\")).then(function(response){return response.json();}).then(function(data){if(data)return postData(json,\"\".concat(host,\"/api/generate/inform\"));// eslint-disable-next-line no-throw-literal\nelse throw\"沒有資料\";}).then(function(response){var FileNameEncode=response.headers.get('Content-Disposition').split('filename=')[1];FileName=decodeURIComponent(FileNameEncode);return response.blob();}).then(function(blob){var url=window.URL.createObjectURL(blob);var a=document.createElement('a');a.href=url;a.download=FileName;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}).catch(function(Error){alert(Error);});}).catch(function(Error){console.log(Error);});}).catch(function(Error){console.log(Error);});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"submit\",onClick:sendAPI,children:\"\\u9001\\u51FA\"})})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","postData","json","api","res","fetch","method","headers","body","JSON","stringify","App","_ref","user_id","program_no","host","sendAPI","FileName","Id","concat","then","response","data","Acadno","id","status","syearEnd","semEnd","StudentId","FileNameEncode","get","split","decodeURIComponent","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","revokeObjectURL","removeChild","catch","Error","alert","console","log","className","children","onClick"],"sources":["C:/Users/Spl/Desktop/fastreport_project/Inform/inform_frontend/src/App.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport './App.css';\n\nasync function postData(json, api) {\n    const res = await fetch(api, {\n        method: \"POST\",\n        headers: {\n            'content-type': 'application/json'\n        },\n        body: JSON.stringify(json)\n    })\n    return res;\n}\n\nconst App = ({user_id, program_no, host}) => {\n    function sendAPI() {\n        var FileName;\n\n        postData({Id: user_id}, `${host}/api/pub/acad`).then(function (response) {\n            return response.json()\n        }).then(function (data) {\n            postData({Acadno: data.id}, `${host}/api/pub/date`)\n                .then(function (response) {\n                    if (response.status === 204)\n                        throw \"不在時限內\";\n                    return response.json()\n                }).then(function (data) {\n                var json = {}\n                json.syearEnd = data.syearEnd;\n                json.semEnd = data.semEnd;\n                json.StudentId = user_id;\n                postData(json, `${host}/api/Calculate`)\n                    .then(function (response) {\n                        return response.json();\n                    }).then(function (data) {\n                    if (data)\n                        return postData(json, `${host}/api/generate/inform`);\n                    // eslint-disable-next-line no-throw-literal\n                    else throw \"沒有資料\";\n                }).then(function (response) {\n                    var FileNameEncode = response.headers.get('Content-Disposition').split('filename=')[1];\n                    FileName = decodeURIComponent(FileNameEncode);\n                    return response.blob();\n                }).then(function (blob) {\n                    var url = window.URL.createObjectURL(blob);\n                    var a = document.createElement('a');\n                    a.href = url;\n                    a.download = FileName;\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    document.body.removeChild(a);\n                }).catch(function (Error) {\n                    alert(Error);\n                });\n            }).catch(function (Error) {\n                console.log(Error);\n            });\n        }).catch(function (Error) {\n            console.log(Error);\n        });\n\n    }\n\n    return (\n        <div className=\"App\">\n            <div>\n                <button className=\"submit\" onClick={sendAPI}>送出</button>\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
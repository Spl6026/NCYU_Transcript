{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";async function postData(json,api){const res=await fetch(api,{method:\"POST\",headers:{'content-type':'application/json'},body:JSON.stringify(json)});return res;}const App=_ref=>{let{user_id,program_no,server,pub_port,cal_port,trans_port}=_ref;function sendAPI(){var FileName;postData({Id:user_id},\"\".concat(server,\":\").concat(pub_port,\"/api/pub/acad\")).then(function(response){return response.json();}).then(function(data){postData({Acadno:data.Id},\"\".concat(server,\":\").concat(pub_port,\"/api/pub/date\")).then(function(response){return response.json();}).then(function(data){if(data){var json={};json.syearEnd=data.syearEnd;json.semEnd=data.semEnd;json.StudentId=user_id;postData(json,\"\".concat(server,\":\").concat(cal_port,\"/api/Calculate\")).then(function(response){return postData(json,\"\".concat(server,\":\").concat(trans_port,\"/api/generate\"));}).then(function(response){var FileNameEncode=response.headers.get('Content-Disposition').split('filename=')[1];FileName=decodeURIComponent(FileNameEncode);return response.blob();}).then(function(blob){var url=window.URL.createObjectURL(blob);var a=document.createElement('a');a.href=url;a.download=FileName;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}).catch(function(Error){console.log(Error);});}else alert(\"不在時限內\");}).catch(function(Error){console.log(Error);});}).catch(function(Error){console.log(Error);});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"submit\",onClick:sendAPI,children:\"\\u9001\\u51FA\"})})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","postData","json","api","res","fetch","method","headers","body","JSON","stringify","App","_ref","user_id","program_no","server","pub_port","cal_port","trans_port","sendAPI","FileName","Id","concat","then","response","data","Acadno","syearEnd","semEnd","StudentId","FileNameEncode","get","split","decodeURIComponent","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","revokeObjectURL","removeChild","catch","Error","console","log","alert","className","children","onClick"],"sources":["C:/Users/Spl/Desktop/fastreport_project/Inform/inform_frontend/src/App.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport './App.css';\n\nasync function postData(json, api) {\n    const res = await fetch(api, {\n        method: \"POST\",\n        headers: {\n            'content-type': 'application/json'\n        },\n        body: JSON.stringify(json)\n    })\n    return res;\n}\n\nconst App = ({user_id, program_no, server, pub_port, cal_port, trans_port}) => {\n    function sendAPI() {\n        var FileName;\n\n        postData({Id: user_id}, `${server}:${pub_port}/api/pub/acad`).then(function (response) {\n            return response.json()\n        }).then(function (data) {\n            postData({Acadno: data.Id}, `${server}:${pub_port}/api/pub/date`)\n                .then(function (response) {\n                    return response.json()\n                }).then(function (data) {\n                if (data) {\n                    var json = {}\n                    json.syearEnd = data.syearEnd;\n                    json.semEnd = data.semEnd;\n                    json.StudentId = user_id;\n                    postData(json, `${server}:${cal_port}/api/Calculate`)\n                        .then(function (response) {\n                            return postData(json, `${server}:${trans_port}/api/generate`);\n                        }).then(function (response) {\n                        var FileNameEncode = response.headers.get('Content-Disposition').split('filename=')[1];\n                        FileName = decodeURIComponent(FileNameEncode);\n                        return response.blob();\n                    }).then(function (blob) {\n                        var url = window.URL.createObjectURL(blob);\n                        var a = document.createElement('a');\n                        a.href = url;\n                        a.download = FileName;\n                        document.body.appendChild(a);\n                        a.click();\n                        window.URL.revokeObjectURL(url);\n                        document.body.removeChild(a);\n                    }).catch(function (Error) {\n                        console.log(Error);\n                    });\n                } else alert(\"不在時限內\");\n            }).catch(function (Error) {\n                console.log(Error);\n            });\n        }).catch(function (Error) {\n            console.log(Error);\n        });\n\n    }\n\n    return (\n        <div className=\"App\">\n            <div>\n                <button className=\"submit\" onClick={sendAPI}>送出</button>\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}